<html>
	<TITLE>Space Invaders</TITLE>

	<canvas id = "spInvaderCanvas" width = 600 height=800> </canvas>

	<body>

		<script>
			//need to add cover
			//need to add enemies
			const FPS = 60;

			var keyState;
			var curKey;
			
			var playerLives = 3;
			var playerX = 300;
			var playerY = 750;
			var playerWidth = 30;
			var playerHeight = 30;
			var moveSpeed = 5;

			var mouseX;
			var mouseY;

			var bulletX;
			var bulletY;
			

			//not sure how I want to implement cover

			var isInMenu = true;
			var isInHelp = false;
			var isRunning = false;
			var isDead = false;


			function getMousePos(evt)
			{
				var rect = canvas.getBoundingClientRect();
				var root = document.documentElement;
				var tempX = evt.clientX - rect.left - root.scrollLeft;
				var tempY = evt.clientY - rect.top - root.scrollTop;
				return{
					x:tempX,
					y:tempY
				};
			}

			function handleMouseClick(evt)
			{
				if(isInMenu && isHovering((canvas.width/2)-40,(canvas.height/2)-80).state)
				{
					isInMenu = false;
					isRunning = true;
				}

				//need to use an else if because of how quickly calculations are done
				if(isInMenu && isHovering((canvas.width/2)-40,(canvas.height/2)-20).state)
				{
					isInMenu = false;
					isInHelp = true;
				}
				else if (isInHelp)
				{
					isInHelp = false;
					isInMenu = true;
				}




			}

			window.onload = function()
			{
				canvas = document.getElementById('spInvaderCanvas');
				canvasContext = canvas.getContext('2d');

				setInterval(function()
					{
						update();
						render();
					},1000/FPS);

				window.addEventListener('keydown',function(evt)
				{
					keyState = true;
					curKey = evt.keyCode;
				});

				window.addEventListener('keyup',function(evt)
				{
					keyState = false;
				});

				window.addEventListener('mousedown',handleMouseClick);

				window.addEventListener('mousemove',function(evt)
				{
					var mousePos = getMousePos(evt);
					mouseY = mousePos.y;
					mouseX = mousePos.x;
				});
			}

			function update()
			{
				checkPlayerMovement();
			}

			function render()
			{
				//!!!after this project need to look into how to control states... could use an array and switch statements intstead of 4 ifs

				//background it almost everything is gonna set background first
				canvasContext.fillStyle = 'black';
				canvasContext.fillRect(0,0,canvas.width,canvas.height);

				if(isInMenu)
				{

					canvasContext.font="30px Arial";
					canvasContext.fillStyle = isHovering((canvas.width/2)-40,(canvas.height/2)-80).color;
					canvasContext.fillText("PLAY",(canvas.width/2)-40,(canvas.height/2)-80);
					canvasContext.fillStyle = isHovering((canvas.width/2)-40,(canvas.height/2)-20).color;
					canvasContext.fillText("HELP",(canvas.width/2)-40,(canvas.height/2)-20);

					// if this was not gitpages I could have added a highscore function
				}

				if(isInHelp)
				{
					canvasContext.fillStyle = "white";
					canvasContext.fillText("Help",(canvas.width/2)-40,(canvas.height/2) -10);


				}
				if(isRunning)
				{

					canvasContext.fillStyle = 'black';
					canvasContext.fillRect(0,0,canvas.width,canvas.height);
					canvasContext.fillStyle = 'red';
					canvasContext.fillRect((playerX-playerWidth),(playerY-playerHeight),playerWidth,playerHeight); 

					//
					//draw cover
				}

				if(isDead)
				{
					canvasContext.fillStyle = "white";
					canvasContext.fillText("GAME OVER",(canvas.width/2)-90,(canvas.height/2) -10);

				}



			}
			
			function isHovering(x,y)
			{
				if( (y>mouseY && (y-40) <mouseY) && (x-10<mouseX && (x+80)>mouseX) )
				{
					return {
						color:'blue',
						state:true
					};
				}

				return {
					color:'white',
					state:false
				};
			}
			
			function checkPlayerMovement()
			{
				//dont need up and down for main game,but possibley for a menu system
				if(keyState && isRunning)
				{
					switch(curKey)
					{
						case false:
							break;
						case 37://left
							playerX-=moveSpeed;
							break;
						case 38: //up
							if(isInMenu)
							{
								playerY-=moveSpeed;
							}
							break;
						case 39: //right
							playerX+=moveSpeed;
							break;
						case 40: //down
							if(isInMenu)
							{
								playerY+=moveSpeed;
							}
							break;
						case 32:
							//space for shooting

							break;

					}
				}


			}
		</script>

	</body>

	<br>
	<a href ="../../HTMLProjects.html"> Back To Projects </a>

</html>
